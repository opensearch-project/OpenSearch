---
"Basic usage returns expected table header":
  - do:
      wlm_stats_list: {}
  - is_true: $body
  - match:
      $body: /(?s).*NODE_ID\s+\|\s+QUERY_GROUP_ID\s+\|\s+TOTAL_COMPLETIONS\s+\|\s+TOTAL_REJECTIONS\s+\|\s+TOTAL_CANCELLATIONS\s+\|\s+CPU_USAGE\s+\|\s+MEMORY_USAGE.*/

---
"Custom size param still returns headers":
  - do:
      wlm_stats_list:
        size: 1
  - is_true: $body
  - match:
      $body: /TOTAL_REJECTIONS/

---
"Sort by node_id asc does not error":
  - do:
      wlm_stats_list:
        sort: node_id
        order: asc
  - is_true: $body
  - match:
      $body: /NODE_ID/

---
"Sort by query_group_id desc does not error":
  - do:
      wlm_stats_list:
        sort: query_group_id
        order: desc
  - is_true: $body
  - match:
      $body: /QUERY_GROUP_ID/

---
"Invalid sort field returns error":
  - do:
      catch: bad_request
      wlm_stats_list:
        sort: memory_usage
        order: desc
  - match:
      error.reason: "Invalid value for 'sort'. Allowed: 'node_id', 'query_group_id'."

---
"Invalid sort order returns error":
  - do:
      catch: bad_request
      wlm_stats_list:
        order: upside_down
  - match:
      error.reason: "Invalid value for 'order'. Allowed: 'asc', 'desc'."
